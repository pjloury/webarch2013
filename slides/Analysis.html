<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Analysis</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="Analysis"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2013-11-21T23:29-0800"/>
<meta name="author" content="Jim Blomo"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>

<link rel="stylesheet" type="text/css" href="production/common.css" />
<link rel="stylesheet" type="text/css" href="production/screen.css" media="screen" />
<link rel="stylesheet" type="text/css" href="production/projection.css" media="projection" />
<link rel="stylesheet" type="text/css" href="production/color-blue.css" media="projection" />
<link rel="stylesheet" type="text/css" href="production/presenter.css" media="presenter" />
<link href='http://fonts.googleapis.com/css?family=Lobster+Two:700|Yanone+Kaffeesatz:700|Open+Sans' rel='stylesheet' type='text/css'>


</head>
<body>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">Analysis</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 <b>Analysis</b></a></li>
<li><a href="#sec-2">2 Overview</a>
<ul>
<li><a href="#sec-2-1">2.1 Details</a></li>
</ul>
</li>
<li><a href="#sec-3">3 Types of Models</a>
<ul>
<li><a href="#sec-3-1">3.1 Some examples</a></li>
<li><a href="#sec-3-2">3.2 Simple to Sophisticated</a></li>
<li><a href="#sec-3-3">3.3 Survey</a></li>
</ul>
</li>
<li><a href="#sec-4">4 Recommenders</a>
<ul>
<li><a href="#sec-4-1">4.1 Simple</a></li>
<li><a href="#sec-4-2">4.2 Collaborative Filter</a></li>
<li><a href="#sec-4-3">4.3 Details</a></li>
</ul>
</li>
<li><a href="#sec-5">5 Classifiers</a>
<ul>
<li><a href="#sec-5-1">5.1 Simple</a></li>
<li><a href="#sec-5-2">5.2 Naive Bayes</a></li>
<li><a href="#sec-5-3">5.3 Probabilities</a></li>
</ul>
</li>
<li><a href="#sec-6">6 Definitions</a>
<ul>
<li><a href="#sec-6-1">6.1 Examples</a></li>
<li><a href="#sec-6-2">6.2 Housing Example</a>
<ul>
<li><a href="#sec-6-2-1">6.2.1 Setup</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-7">7 Regression Analysis</a>
<ul>
<li><a href="#sec-7-1">7.1 Calculation</a></li>
</ul>
</li>
<li><a href="#sec-8">8 <b>Calculation</b></a>
<ul>
<li><a href="#sec-8-1">8.1 Switch Gears</a></li>
</ul>
</li>
<li><a href="#sec-9">9 Tools</a>
<ul>
<li><a href="#sec-9-1">9.1 Details</a></li>
</ul>
</li>
<li><a href="#sec-10">10 MapReduce</a>
<ul>
<li><a href="#sec-10-1">10.1 Reading</a></li>
<li><a href="#sec-10-2">10.2 Example</a>
<ul>
<li><a href="#sec-10-2-1">10.2.1 Details</a></li>
</ul>
</li>
<li><a href="#sec-10-3">10.3 Map</a></li>
<li><a href="#sec-10-4">10.4 Map Example</a>
<ul>
<li><a href="#sec-10-4-1">10.4.1 Counts</a></li>
</ul>
</li>
<li><a href="#sec-10-5">10.5 Status?</a>
<ul>
<li><a href="#sec-10-5-1">10.5.1 Middle Step</a></li>
</ul>
</li>
<li><a href="#sec-10-6">10.6 Reduce</a>
<ul>
<li><a href="#sec-10-6-1">10.6.1 Value*s*</a></li>
</ul>
</li>
<li><a href="#sec-10-7">10.7 Reduce Example</a>
<ul>
<li><a href="#sec-10-7-1">10.7.1 Details</a></li>
</ul>
</li>
<li><a href="#sec-10-8">10.8 Example Output</a></li>
</ul>
</li>
<li><a href="#sec-11">11 Point?</a>
<ul>
<li><a href="#sec-11-1">11.1 Details</a></li>
<li><a href="#sec-11-2">11.2 Implementation</a></li>
<li><a href="#sec-11-3">11.3 Intermediate</a></li>
<li><a href="#sec-11-4">11.4 "Shuffle"</a></li>
<li><a href="#sec-11-5">11.5 Distribute</a></li>
<li><a href="#sec-11-6">11.6 Inputs</a>
<ul>
<li><a href="#sec-11-6-1">11.6.1 Splitting Files</a></li>
</ul>
</li>
<li><a href="#sec-11-7">11.7 Incorrect Log Style</a>
<ul>
<li><a href="#sec-11-7-1">11.7.1 No!</a></li>
</ul>
</li>
<li><a href="#sec-11-8">11.8 Correct Log Style</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> <b>Analysis</b> &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-1">


</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Overview &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-2">

<ul>
<li>What can you do with data?
</li>
<li>How?
</li>
</ul>


</div>

<div id="outline-container-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Details &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-2-1">

<ul>
<li>Types of models
</li>
<li>Simple stats
</li>
<li>MapReduce for homework
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Types of Models &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span>&nbsp;<span class="animate">animate</span></span></h2>
<div class="outline-text-2" id="text-3">

<ul>
<li>Recommenders
</li>
<li>Classifiers
</li>
<li>Regressions
</li>
<li>Outliers
</li>
</ul>


</div>

<div id="outline-container-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Some examples &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-3-1">

<ul>
<li>Question: how are models used in the real world?
</li>
<li>Amazon or Netflix style recommendations based on prior history
</li>
<li>Spam/Ham for email, also clustering and discovering classifications
</li>
<li>Guessing the price of a house (Zillow or Redfin)
</li>
<li>find anomalous transactions, eg. finding fraud for credit cards
</li>
</ul>


</div>

</div>

<div id="outline-container-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Simple to Sophisticated &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span>&nbsp;<span class="two_col">two_col</span></span></h3>
<div class="outline-text-3" id="text-3-2">

<p><img src="img/iceberg11.jpg"  alt="img/iceberg11.jpg" />
</p><ul>
<li>Thousands of ways to calculate a model
</li>
<li>Combinatorially more ways to combine them
</li>
<li>In technique, large amount of overlap between purpose
</li>
</ul>

</div>

</div>

<div id="outline-container-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Survey &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-3-3">

<ul>
<li>ML and DM fields churn these models out
</li>
<li>Newest methods combine multiple models (boosting &amp; bagging)
</li>
<li>If you want to learn more, we'll cover some of this in Data Mining
</li>
<li>We're just going to go over the most well known model for each type
</li>
<li>In general, this is the right way to approach it: start very simple, get
     sophisticated in order to correct for specific problems in your domain
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Recommenders &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span>&nbsp;<span class="animate">animate</span></span></h2>
<div class="outline-text-2" id="text-4">

<ul>
<li>Popularity
</li>
<li>Collaborative Filter
</li>
</ul>


</div>

<div id="outline-container-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Simple &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-4-1">

<ul>
<li>For all of these, start simple
</li>
<li>If I told you the homework was a recommender system, and you could make it
     as simple as you'd like, what technique would you use?
</li>
<li>Amazon Personalization team: just recommend Harry Potter
</li>
<li>Next step: Collaborative Filter
</li>
<li>What do people who are similar to you like?
</li>
</ul>


</div>

</div>

<div id="outline-container-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> Collaborative Filter &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span>&nbsp;<span class="two_col">two_col</span></span></h3>
<div class="outline-text-3" id="text-4-2">

<ol>
<li>Find people similar you
</li>
<li>Find what they like
</li>
<li>Recommend new items to you
</li>
</ol>



<ol>
<li>Find items you've liked
</li>
<li>Find similar items to those
</li>
<li>Recommend new items to you
</li>
</ol>

</div>

</div>

<div id="outline-container-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> Details &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-4-3">

<ul>
<li>In general, challenge is being specific about words
</li>
<li>What does it mean to be similar to you?
<ul>
<li>Bought the same stuff
</li>
<li>Is a friend
</li>
<li>Same demographic
</li>
</ul>

</li>
<li>What does it mean to be similar to an item?
<ul>
<li>Bought by same people
</li>
<li>Same category
</li>
<li>Similar description
<ul>
<li>What does it mean to have a similar description?
</li>
</ul>

</li>
</ul>

</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Classifiers &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span>&nbsp;<span class="two_col">two_col</span>&nbsp;<span class="animate">animate</span></span></h2>
<div class="outline-text-2" id="text-5">

<p><img src="img/viagra-spam-email-message.jpg"  alt="img/viagra-spam-email-message.jpg" />
</p><ul>
<li>Spam/Ham decision
</li>
<li>Existence of word (eg. Viagra)
</li>
<li>Now what about V1agraa?
</li>
<li>Naive Bayes classifier
</li>
</ul>


</div>

<div id="outline-container-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> Simple &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-5-1">

<ul>
<li>Again, what would you do right now?
</li>
<li>Check for spammy words
</li>
<li>How do you keep learning the words that are spammy?
</li>
<li>Is "Russian" spammy? Maybe only for some people?
</li>
</ul>


</div>

</div>

<div id="outline-container-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> Naive Bayes &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-5-2">

<p><img src="img/bayes-theorem.png"  alt="img/bayes-theorem.png" />
</p><ul>
<li>Probability of spam given it contains Viagra (W)
</li>
<li>Probability of spam * probability of that word given spam
</li>
<li>Over probability of that word in either
</li>
</ul>

</div>

</div>

<div id="outline-container-5-3" class="outline-3">
<h3 id="sec-5-3"><span class="section-number-3">5.3</span> Probabilities &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-5-3">

<ul>
<li>We're not going to say <i>for sure</i> spam or not, just calculate the
     probability
</li>
<li>Learn that probability based on past examples
</li>
<li>Intuition: if Viagra is always showing up in spammy mail, a new mail with
     Viagra is likely to be spam
</li>
<li>Lots of logical problems with Naive Bayes, but in practice, works quite
     well
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> Definitions &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-6">

<dl>
<dt>Class</dt><dd>Group or type that an item belongs to
</dd>
<dt>Feature</dt><dd>An extractable property of an item that may be useful in
    classification. aka Signal
</dd>
<dt>Label</dt><dd>True class or property of an item
</dd>
<dt>Training Set</dt><dd>Items that have been labeled
</dd>
</dl>


</div>

<div id="outline-container-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> Examples &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-6-1">

<dl>
<dt>Class</dt><dd>Spam/Ham
</dd>
<dt>Feature</dt><dd>"contains word Viagra", "was purchased by Sally"
</dd>
<dt>Label</dt><dd>Clicking "Spam" button in Gmail
</dd>
<dt>Training Set</dt><dd>All of the email you've clicked Spam/Not Spam
</dd>
</dl>


</div>

</div>

<div id="outline-container-6-2" class="outline-3">
<h3 id="sec-6-2"><span class="section-number-3">6.2</span> Housing Example &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-6-2">

<dl>
<dt>Class</dt><dd>Customer likes it or not
</dd>
<dt>Features</dt><dd>Price, city, square footage, # bed/bath
</dd>
<dt>Label</dt><dd>Like/Don't Like
</dd>
<dt>Training Set</dt><dd>Houses customer has toured or bid
</dd>
</dl>


</div>

<div id="outline-container-6-2-1" class="outline-4">
<h4 id="sec-6-2-1"><span class="section-number-4">6.2.1</span> Setup &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h4>
<div class="outline-text-4" id="text-6-2-1">

<ul>
<li>Let's say you're Redfin trying to recommend a house to a customer
</li>
<li>Customer likes it
</li>
<li>Price, city, square footage, # bed/bath
</li>
<li>Like/Don't Like
</li>
<li>Houses customer has toured or bid
</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> Regression Analysis &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-7">

<ul>
<li>Estimate the <i>price</i> of the house
</li>
<li>Model the relationship of all the features to the outcome
</li>
<li>In general, features are numbers, estimate is a number
</li>
</ul>

<p><img src="img/sqft-price.png"  alt="img/sqft-price.png" />
</p>
</div>

<div id="outline-container-7-1" class="outline-3">
<h3 id="sec-7-1"><span class="section-number-3">7.1</span> Calculation &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-7-1">

<ul>
<li>In general want to minimize the space between the points and the line
</li>
<li>Like in the case of Yelp reviews, may need different formulas to draw lines
</li>
<li>Numbers in, number out
</li>
<li>So "city" may not be a good feature for regression, but what could you
     replace it with?
<ul>
<li>Average price of home in city
</li>
</ul>

</li>
<li>And what would the training set be?
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> <b>Calculation</b> &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-8">


</div>

<div id="outline-container-8-1" class="outline-3">
<h3 id="sec-8-1"><span class="section-number-3">8.1</span> Switch Gears &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-8-1">

<ul>
<li>Let's talk about how models and analysis are done
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-9" class="outline-2">
<h2 id="sec-9"><span class="section-number-2">9</span> Tools &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-9">

<dl>
<dt>Languages</dt><dd>Matlab Python R SQL
</dd>
<dt>Tools</dt><dd>Unix MySQL ReST scikit-learn
</dd>
<dt>Paradigms</dt><dd>Single-Threaded Concurrent MapReduce
</dd>
</dl>


</div>

<div id="outline-container-9-1" class="outline-3">
<h3 id="sec-9-1"><span class="section-number-3">9.1</span> Details &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-9-1">

<ul>
<li>Languages are in alphabetical order. Real order depends on what you like,
     what you're doing, interfacing with, etc.
</li>
<li>Unix tools like <code>less</code> <code>wget</code> <code>head</code> <code>cut</code>
</li>
<li>scikit-learn machine learning Python library
</li>
<li>Single-Threaded, what you're used to when running a single program
</li>
<li>How do you split up a task, eg. extracting all of the features from items?
</li>
<li>Concurrent programs trickier, many processes are happening at once. Track
     shared state.
</li>
<li>MapReduce is what we'll focus on, widely used in industry, buys you a lot
     of scalability, structured way to think about a problem
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-10" class="outline-2">
<h2 id="sec-10"><span class="section-number-2">10</span> MapReduce &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-10">

<dl>
<dt>Map</dt><dd>Extract a property to summarize over
</dd>
<dt>Reduce</dt><dd>Summarize all items with a particular propery
</dd>
</dl>



<ul>
<li>Simple: Each operation stateless
</li>
</ul>


</div>

<div id="outline-container-10-1" class="outline-3">
<h3 id="sec-10-1"><span class="section-number-3">10.1</span> Reading &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-10-1">

<ul>
<li>Reading this week includes a video explaining MapReduce much more generally
</li>
<li>This lecture will focus on it from a practical standpoint for homework
</li>
<li>MapReduce's main benefits are for running over many machine, fault
     tolerance
</li>
<li>But we'll just practice on one machine
</li>
</ul>


</div>

</div>

<div id="outline-container-10-2" class="outline-3">
<h3 id="sec-10-2"><span class="section-number-3">10.2</span> Example &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-10-2">

<ul>
<li>URL Shortener
</li>
<li>How many actions have we seen?
</li>
<li>Redirects: 200, Saves: 40, Loads: 60
</li>
</ul>


</div>

<div id="outline-container-10-2-1" class="outline-4">
<h4 id="sec-10-2-1"><span class="section-number-4">10.2.1</span> Details &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h4>
<div class="outline-text-4" id="text-10-2-1">

<dl>
<dt>Redirects</dt><dd>How many times have we expanded a short link to a long one?
</dd>
<dt>Saves</dt><dd>How many times have we saved a new URL?
</dd>
<dt>Loads</dt><dd>How many times have we just loaded the front page?
</dd>
<dt>First</dt><dd>So first step in MapReduce is what?
</dd>
</dl>


</div>
</div>

</div>

<div id="outline-container-10-3" class="outline-3">
<h3 id="sec-10-3"><span class="section-number-3">10.3</span> Map &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-10-3">

<dl>
<dt>Input</dt><dd>Key, Value
</dd>
<dt>Output</dt><dd>Keys, Values
</dd>
</dl>


</div>

</div>

<div id="outline-container-10-4" class="outline-3">
<h3 id="sec-10-4"><span class="section-number-3">10.4</span> Map Example &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-10-4">

<dl>
<dt>Input Key</dt><dd>Log line number
</dd>
<dt>Input Value</dt><dd>Log line text
</dd>
<dt>Output Key</dt><dd>Action
</dd>
<dt>Output Value</dt><dd>times this action has occurred on this line
</dd>
</dl>


</div>

<div id="outline-container-10-4-1" class="outline-4">
<h4 id="sec-10-4-1"><span class="section-number-4">10.4.1</span> Counts &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h4>
<div class="outline-text-4" id="text-10-4-1">

<ul>
<li>Log line number is not helpful in our specific case
</li>
<li>Log line text: we hope it is machine readable so we can accurately extract
     the action
</li>
<li>It has datetime, cookie, action, etc.
</li>
<li>How many times has this action occurred? 1
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-10-5" class="outline-3">
<h3 id="sec-10-5"><span class="section-number-3">10.5</span> Status? &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-10-5">




<pre class="src src-text">load            1
save            1
redirect        1
redirect        1
load            1
redirect        1
load            1
save            1
redirect        1
</pre>


</div>

<div id="outline-container-10-5-1" class="outline-4">
<h4 id="sec-10-5-1"><span class="section-number-4">10.5.1</span> Middle Step &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h4>
<div class="outline-text-4" id="text-10-5-1">

<ul>
<li>From log lines, we've extracted the information out that we care about
</li>
<li>The counts and the actions
</li>
<li>Next step summarize
</li>
<li>Next step after Map?
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-10-6" class="outline-3">
<h3 id="sec-10-6"><span class="section-number-3">10.6</span> Reduce &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-10-6">

<dl>
<dt>Input</dt><dd>Key, Values
</dd>
<dt>Output</dt><dd>Keys, Values
</dd>
</dl>


</div>

<div id="outline-container-10-6-1" class="outline-4">
<h4 id="sec-10-6-1"><span class="section-number-4">10.6.1</span> Value*s* &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h4>
<div class="outline-text-4" id="text-10-6-1">

<ul>
<li>Note: The input is values! Plural
</li>
<li>Because we get a key and all of its associated values
</li>
<li>Remind me: what are we trying to get out of this computation?
</li>
<li>So what do you think the output keys are?
</li>
<li>Values?
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-10-7" class="outline-3">
<h3 id="sec-10-7"><span class="section-number-3">10.7</span> Reduce Example &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-10-7">

<dl>
<dt>Input Key</dt><dd>Action
</dd>
<dt>Input Values</dt><dd>Counts: <code>[1,1,1,1]</code>
</dd>
<dt>Output Key</dt><dd>Action
</dd>
<dt>Output Value</dt><dd>Total Count
</dd>
</dl>


</div>

<div id="outline-container-10-7-1" class="outline-4">
<h4 id="sec-10-7-1"><span class="section-number-4">10.7.1</span> Details &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h4>
<div class="outline-text-4" id="text-10-7-1">

<ul>
<li>Action is <b>one of</b> load save redirect
</li>
<li>To get total count, sum all of the counts
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-10-8" class="outline-3">
<h3 id="sec-10-8"><span class="section-number-3">10.8</span> Example Output &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-10-8">

<dl>
<dt>Output Key</dt><dd>Action
</dd>
<dt>Output Value</dt><dd>Total Count
</dd>
</dl>




<pre class="src src-html">"redirect"  4
"save"      2
"load"      3
</pre>


</div>
</div>

</div>

<div id="outline-container-11" class="outline-2">
<h2 id="sec-11"><span class="section-number-2">11</span> Point? &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-11">

<ul>
<li>A lot of work for counting!
</li>
<li>More complex calculations can be done this way, eg. PageRank
</li>
<li>Stateless constraint means it can be used across thousands of computers
</li>
</ul>


</div>

<div id="outline-container-11-1" class="outline-3">
<h3 id="sec-11-1"><span class="section-number-3">11.1</span> Details &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-11-1">

<ul>
<li>By only looking at keys and values, can optimize a lot of backend work
</li>
<li>Where to send the results?
</li>
<li>What to do when a computer fails? (Just restart failed part)
</li>
</ul>


</div>

</div>

<div id="outline-container-11-2" class="outline-3">
<h3 id="sec-11-2"><span class="section-number-3">11.2</span> Implementation &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-11-2">




<pre class="src src-text">load            1
save            1
redirect        1
redirect        1
load            1
redirect        1
load            1
save            1
redirect        1
</pre>

</div>

</div>

<div id="outline-container-11-3" class="outline-3">
<h3 id="sec-11-3"><span class="section-number-3">11.3</span> Intermediate &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-11-3">

<ul>
<li>This was the situation after map
</li>
<li>Keys all jumbled
</li>
<li>What Hadoop does is sort them and distribute them to computers
</li>
</ul>


</div>

</div>

<div id="outline-container-11-4" class="outline-3">
<h3 id="sec-11-4"><span class="section-number-3">11.4</span> "Shuffle" &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-11-4">




<pre class="src src-text">load            1
load            1
load            1
redirect        1
redirect        1
redirect        1
redirect        1
save            1
save            1
</pre>

</div>

</div>

<div id="outline-container-11-5" class="outline-3">
<h3 id="sec-11-5"><span class="section-number-3">11.5</span> Distribute &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h3>
<div class="outline-text-3" id="text-11-5">

<ul>
<li>Now it is easy to distribute, and can handle all the <code>load</code> at once
</li>
</ul>


</div>

</div>

<div id="outline-container-11-6" class="outline-3">
<h3 id="sec-11-6"><span class="section-number-3">11.6</span> Inputs &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-11-6">

<ul>
<li>MapReduce distributes computing power by distributing input
</li>
<li>Input is distributed by splitting on lines (records)
</li>
<li>You cannot depend on lines being "together" in MapReduce
</li>
</ul>


</div>

<div id="outline-container-11-6-1" class="outline-4">
<h4 id="sec-11-6-1"><span class="section-number-4">11.6.1</span> Splitting Files &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h4>
<div class="outline-text-4" id="text-11-6-1">

<ul>
<li>Image you have a lot of large log files, GB each
</li>
<li>You'd like to let different machines work on the same file
</li>
<li>Split file down the middle, well, at least on a newline
</li>
<li>Enable two separate machines to work on the parts
</li>
<li>You don't know what line came before this one
</li>
<li>You don't know if you will process the next line
</li>
<li>Only view is this line
</li>
<li>Real life slightly more complicated, but mostly hacks around this
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-11-7" class="outline-3">
<h3 id="sec-11-7"><span class="section-number-3">11.7</span> Incorrect Log Style &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-11-7">

<ul>
<li>URL Shortener logging
</li>
</ul>




<pre class="src src-python">app.logger.info(<span style="color: #8b2252;">"Handling request for "</span> + cookie)
...
<span style="color: #b22222;"># find redirect</span>
...
app.logger.info(<span style="color: #8b2252;">"Redirecting to "</span> + destination)
</pre>

<ul>
<li>Ability to associate the redirect with the
      cookie?
<ul>
<li>eg. which cookie had the most redirects?
</li>
</ul>

</li>
</ul>


</div>

<div id="outline-container-11-7-1" class="outline-4">
<h4 id="sec-11-7-1"><span class="section-number-4">11.7.1</span> No! &nbsp;&nbsp;&nbsp;<span class="tag"><span class="notes">notes</span></span></h4>
<div class="outline-text-4" id="text-11-7-1">

<ul>
<li>Must log everything on same line
</li>
<li>One machine could have the "Handling request.." Another could have
      "Redirecting to&hellip;"
</li>
<li>Collect it all, then log it
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-11-8" class="outline-3">
<h3 id="sec-11-8"><span class="section-number-3">11.8</span> Correct Log Style &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h3>
<div class="outline-text-3" id="text-11-8">

<ul>
<li>Logging once
</li>
</ul>




<pre class="src src-python">log_data[<span style="color: #8b2252;">'cookie'</span>] = cookie
...
<span style="color: #b22222;"># find redirect</span>
log_data[<span style="color: #8b2252;">'action'</span>] = <span style="color: #8b2252;">'redirect'</span>
app.logger.info(json.dumps(log_data))
</pre>



<script type="text/javascript" src="production/org-html-slideshow.js"></script>




</div>
</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2013-11-21T23:29-0800</p>
<p class="author">Author: Jim Blomo</p>
<p class="creator"><a href="http://orgmode.org">Org</a> version 7.9.2 with <a href="http://www.gnu.org/software/emacs/">Emacs</a> version 23</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
